name: CI

on: [push]

jobs:
  deploy:
    runs-on: [ubuntu-latest]
    steps:
      #- uses: actions/checkout@v1
      #- name: Push to server
      #  uses: appleboy/ssh-action@master
      #  with:
      #    host: ${{ secrets.SERVER_IP }}
      #    username: ${{ secrets.SERVER_USERNAME }}
      #    key: ${{ secrets.SSH_PRIVATE_KEY }}
      #    password: ${{ secrets.SERVER_PASSWORD }}
      #    script: cd /var/www/html/Fiscus_bis && sudo git pull

      #  uses: easingthemes/ssh-deploy@v2.1.4
      #  env:
      #      SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
      #      REMOTE_HOST: ${{ secrets.SERVER_IP }}
      #      REMOTE_USER: ${{ secrets.SERVER_USERNAME }}
      #      TARGET: "/var/www/html/Fiscus_bis"

      steps:
        - name: Install SSH Key
          uses: shimataro/ssh-key-action@v2
          with:
            key: ${{ secrets.SSH_PRIVATE_KEY }} 
            known_hosts: 'aaa'
        - name: Adding Known Hosts
          run: ssh-keyscan -H ${{ secrets.SSH_HOST }} >> ~/.ssh/known_hosts
        - name: Deploy with rsync
          run: rsync -avz . ${{ secrets.SSH_USER }}@${{ secrets.SSH_HOST }}:/var/www/html/

      #${{ secrets.SERVER_IP }}
      #${{ secrets.SERVER_PASSWORD }}
      #${{ secrets.SERVER_USERNAME }}
      #${{ secrets.SSH_HOST }}
      #${{ secrets.SSH_PRIVATE_KEY }}
      #${{ secrets.SSH_PRIVATE_KEY_BEGIN_END }}
      #${{ secrets.SSH_PUBLIC_KEY }}